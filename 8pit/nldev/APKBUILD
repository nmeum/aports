# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=nldev
pkgver=0.3_git20160208
pkgrel=0
verbase=0.3
pkgdesc="A simple netlink device manager"
url="http://git.r-36.net/nldev/"
arch="all"
license="MIT"
depends=""
depends_dev=""
makedepends="linux-headers"
install=""
subpackages="$pkgname-doc"
source="http://files.8pit.net/alpine/distfiles/$pkgname-$pkgver.tar.gz
	nldev-path.patch
	mdev-path.patch"

disturl="lithium:/var/www/htdocs/files.8pit.net/alpine/distfiles/"
reporev="e8a7f8c4131d39eaff0ebb186f6ee01a08db3e59"
giturl="git://git.r-36.net/$pkgname"

_builddir="$srcdir"/$pkgname-$pkgver
prepare() {
	local i
	cd "$_builddir"
	for i in $source; do
		case $i in
		*.patch) msg $i; patch -p1 -i "$srcdir"/$i || return 1;;
		esac
	done
}

build() {
	make CFLAGS="$CFLAGS \${INCS} \${CPPFLAGS}" \
		LDFLAGS="$LDFLAGS \${LIBS}" CC="${CC:-gcc}" \
		-C "$_builddir" || return 1
}

package() {
	cd "$_builddir"
	make DESTDIR="$pkgdir" PREFIX=/usr install || return 1

	mkdir -p "$pkgdir"/usr/share/doc/$pkgname/examples/
	install -m644 FIXES.md README.md \
		"$pkgdir"/usr/share/doc/$pkgname/ || return 1
	install -m644 mdev/etc/* \
		"$pkgdir"/usr/share/doc/$pkgname/examples || return 1
	install -m755 mdev/lib/* \
		"$pkgdir"/usr/share/doc/$pkgname/examples || return 1
}

md5sums="180f83ca7127c933df6b23470f4f00f4  nldev-0.3_git20160208.tar.gz
38dba8b01732b39cd5f298defafb014a  nldev-path.patch
32f0308b3fe53945e414e8e0fdc8e011  mdev-path.patch"
sha256sums="5e361bf923b617dd68cc646acdebb83cc730027ac7f8b0dc40cc3a70c4f6915e  nldev-0.3_git20160208.tar.gz
5c581188325bb87143a701faa6ba7ff7fcbca9487c0150316655573099346a82  nldev-path.patch
e0747984c69a0561070a62601a5e58a27ed94d4858529f3ca7af2bc9f85c5479  mdev-path.patch"
sha512sums="70d9243593030e40735b5d089654f80dce8f8f33f0eea677b30a165be2a78c029688cc05922347ee37538178e5f6302fc8787114d5f0e790ec3018b1d79a56fa  nldev-0.3_git20160208.tar.gz
9e249dd877b4aa937cbae260442acc43f501015442f42af986e0884bb6a163bc9d30fc849afd3cb5257480a0f9c2b1c43aaa15953c9a77c4dfcb84b35a897389  nldev-path.patch
1d17460e83f4f0a48b3c591c6966cb9cad88f0f5bbc631aef68e4fe70efef2569032bf0a1d6a378a9aed7edfa7a08e203b519545bc500635e520ff46f4e4d622  mdev-path.patch"
