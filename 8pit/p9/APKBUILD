# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=p9
pkgver=0_git20200120
_commit=e521180b4735c4480b400c381422fe1776a0ecc8
pkgrel=0
pkgdesc="Idiomatic Go 9P2000.L client and server"
url="https://github.com/nmeum/p9"
arch="all"
license="Apache-2.0"
makedepends="go"
options="net"
source="$pkgname-$pkgver.tar.gz::https://github.com/hugelgupf/p9/archive/$_commit.tar.gz"
builddir="$srcdir/github.com/hugelgupf/$pkgname"

export GOPATH="$srcdir"

prepare() {
	default_prepare
	cd "$srcdir"
	mkdir -p "$(dirname "$builddir")"
	cp -r "$srcdir/$pkgname-$_commit" "$builddir"
}

build() {
	mkdir -p bin
	go build -o bin github.com/hugelgupf/p9/cmd/...
}

check() {
	go test ./...
}

package() {
	mkdir -p "$pkgdir"/usr/bin
	install -m755 bin/* "$pkgdir"/usr/bin/
}

cleanup_srcdir() {
	go clean -modcache
	default_cleanup_srcdir
}

sha512sums="99998dd758c9c1768a9dab25e4c690f410b761a2c11a3e1065490d370a6af165c465f03abd7c4b4a66bb54845913d2e562fcf840c10236ee476391ce48668c46  p9-0_git20200120.tar.gz"
